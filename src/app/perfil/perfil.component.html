<app-top-bar></app-top-bar>
<app-sidebar></app-sidebar>

<main class="profile-container">
  <div class="profile-card">
    <div class="profile-content">
      <!-- Avatar -->
      <div class="profile-avatar">
        <span class="avatar-icon"></span>
      </div>

      <!-- Profile Fields -->
      <div class="profile-fields">
        <div class="field-group">
          <label class="field-label">Nombre</label>
          <div class="field-value">{{ profile.nombre }}</div>
        </div>
        <div class="field-group">
          <label class="field-label">Correo</label>
          <div class="field-value">{{ profile.correo }}</div>
        </div>
        <div class="field-group">
          <label class="field-label">Teléfono</label>
          <div class="field-value">{{ profile.telefono }}</div>
        </div>
        <div class="field-group">
          <label class="field-label">Rol</label>
          <div class="field-value">{{ profile.rol }}</div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="button-group">
        <button (click)="openEditModal()" class="btn-primary">Editar Perfil</button>
        <button (click)="openPasswordModal()" class="btn-secondary">Cambiar la Contraseña</button>
      </div>
    </div>
  </div>

  <!-- Edit Profile Modal -->
  <div *ngIf="showEditModal" class="modal-overlay">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Editar Perfil</h2>
        <span class="close-btn" (click)="closeAllModals()">×</span>
      </div>
      <div class="modal-body">
        <div class="edit-avatar-container">
          <div class="profile-avatar">
            <span class="avatar-icon"></span>
          </div>
          <button (click)="openPhotoModal()" class="photo-link">Cambiar Foto</button>
        </div>
        <div class="form-fields">
          <div class="form-group">
            <label class="form-label" for="nombre">Nombre</label>
            <input id="nombre" type="text" name="nombre" [(ngModel)]="profile.nombre" (input)="handleProfileChange($event)" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="correo">Correo</label>
            <input id="correo" type="email" name="correo" [(ngModel)]="profile.correo" (input)="handleProfileChange($event)" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="telefono">Teléfono</label>
            <input id="telefono" type="tel" name="telefono" [(ngModel)]="profile.telefono" (input)="handleProfileChange($event)" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="rol">Rol</label>
            <input id="rol" type="text" name="rol" [(ngModel)]="profile.rol" (input)="handleProfileChange($event)" class="form-input" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button (click)="closeAllModals()" class="btn-secondary">Cancelar</button>
        <button (click)="saveProfile()" class="btn-primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Change Photo Modal -->
  <div *ngIf="showPhotoModal" class="modal-overlay">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Cambiar Foto de Perfil</h2>
        <span class="close-btn" (click)="closeAllModals()">×</span>
      </div>
      <div class="modal-body">
        <div class="photo-upload-container">
          <div class="profile-avatar large">
            <span class="avatar-icon"></span>
          </div>
          <p class="photo-status">Esta es la foto actual del perfil.</p>
          <label class="file-input-label">
            <input type="file" (change)="onFileSelected($event)" accept=".jpg,.jpeg,.png" class="file-input" />
            Seleccionar Archivo
          </label>
          <p class="file-formats">Formatos permitidos: JPG, PNG</p>
        </div>
      </div>
      <div class="modal-footer">
        <button (click)="closeAllModals()" class="btn-secondary">Cancelar</button>
        <button (click)="savePhoto()" class="btn-primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Change Password Modal -->
  <div *ngIf="showPasswordModal" class="modal-overlay">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Cambiar Contraseña</h2>
        <span class="close-btn" (click)="closeAllModals()">×</span>
      </div>
      <div class="modal-body">
        <p class="password-instruction">Introduce una nueva contraseña para tu cuenta.</p>
        <div class="form-fields">
          <div class="form-group">
            <label class="form-label" for="new-password">Contraseña Nueva</label>
            <input id="new-password" type="password" name="new" [(ngModel)]="passwords.new" (input)="handlePasswordChange($event)" class="form-input" />
          </div>
          <div class="form-group">
            <label class="form-label" for="confirm-password">Confirmar Contraseña</label>
            <input id="confirm-password" type="password" name="confirm" [(ngModel)]="passwords.confirm" (input)="handlePasswordChange($event)" class="form-input" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button (click)="closeAllModals()" class="btn-secondary">Cancelar</button>
        <button (click)="savePassword()" class="btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</main>