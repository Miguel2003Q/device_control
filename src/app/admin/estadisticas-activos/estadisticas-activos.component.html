<app-top-bar (toggleSidebar)="toggleSidebarEmit()"></app-top-bar>
<app-sidebar [active]="sidebarActive"></app-sidebar>

<!-- estadisticas-activos.component.html -->
<div class="estadisticas-container">
  <!-- Header con acciones -->
  <div class="page-header">
    <div class="header-content">
      <h1>Estadísticas de Activos</h1>
      <p class="subtitle">Análisis completo del estado y utilización de activos</p>
    </div>
    <div class="header-actions">
      <button class="btn-action" (click)="refreshData()" [disabled]="loading">
        <i class="fas fa-sync-alt" [class.fa-spin]="loading"></i>
        Actualizar
      </button>
      <button class="btn-primary" (click)="viewPDF()">
        <i class="fas fa-file-pdf"></i>
        Ver PDF
      </button>
      <button class="btn-success" (click)="downloadPDF()">
        <i class="fas fa-download"></i>
        Descargar PDF
      </button>
      <button class="btn-excel" (click)="downloadExcel()">
        <i class="fas fa-file-excel"></i>
        Descargar Excel
      </button>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Cargando estadísticas...</p>
  </div>

  <!-- Contenido principal -->
  <div class="estadisticas-content" *ngIf="!loading && estadisticas">
    
    <!-- Tarjetas de resumen -->
    <div class="stats-grid">
      <div class="stat-card primary">
        <div class="stat-icon">
          <i class="fas fa-boxes"></i>
        </div>
        <div class="stat-content">
          <h3>{{ estadisticas.totalEspacios }}</h3>
          <p>Total Activos</p>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ estadisticas.totalEspaciosActivos }}</h3>
          <p>Activos Disponibles</p>
          <span class="percentage">{{ estadisticas.porcentajeEspaciosActivos | number:'1.1-1' }}%</span>
        </div>
      </div>

      <div class="stat-card danger">
        <div class="stat-icon">
          <i class="fas fa-times-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ estadisticas.totalEspaciosEliminados }}</h3>
          <p>Activos Dañados/Baja</p>
          <span class="percentage">{{ estadisticas.porcentajeactivosEliminados | number:'1.1-1' }}%</span>
        </div>
      </div>

      <div class="stat-card info">
        <div class="stat-icon">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
          <h3>{{ estadisticas.capacidadTotal }}</h3>
          <p>Capacidad Total</p>
          <span class="average">Promedio: {{ estadisticas.capacidadPromedio | number:'1.1-1' }}</span>
        </div>
      </div>
    </div>

    <!-- Aquí todo lo demás sigue igual (gráficos, top 10, análisis de utilización, JSON, modal de PDF) -->

  </div>

  <!-- Estado vacío -->
  <div class="empty-state" *ngIf="!loading && !estadisticas">
    <i class="fas fa-chart-bar"></i>
    <h3>No hay datos disponibles</h3>
    <p>No se pudieron cargar las estadísticas. Por favor, intenta nuevamente.</p>
    <button class="btn-primary" (click)="loadEstadisticas()">
      <i class="fas fa-refresh"></i>
      Reintentar
    </button>
  </div>
</div>
